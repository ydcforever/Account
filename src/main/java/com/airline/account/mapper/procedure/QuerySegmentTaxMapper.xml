<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airline.account.mapper.procedure.QuerySegmentTaxMapper">
    <resultMap type="com.airline.account.prorate.SegmentTax" id="SegmentTax">
        <!-- QueryTaxs的返回值 -->
        <result column="SEGMENT_NO" property="segNo" jdbcType="VARCHAR" />
        <result column="SALE_CURRENCY" property="saleCur" jdbcType="VARCHAR" />
        <result column="TAX_CODE" property="taxCode" jdbcType="VARCHAR" />
        <result column="TAX_AMOUNT" property="amount" jdbcType="DECIMAL" />
        <result column="TAX_NAME" property="taxName" jdbcType="VARCHAR"/>
    </resultMap>

    <select id="querySegmentTax" parameterType="java.util.Map"
            statementType="CALLABLE">
        <!--statementType 存储过程 -->
        {CALL
        atpco_coupon_tax_yq
        (
        #{routing,mode=IN,jdbcType=VARCHAR},
        #{turnaround_no, mode=IN, jdbcType=NUMERIC},
        #{booking_date,mode=IN,jdbcType=VARCHAR},
        #{marketing_carrier,mode=IN,jdbcType=VARCHAR},
        #{operating_carrier,mode=IN,jdbcType=VARCHAR},
        #{flights,mode=IN,jdbcType=VARCHAR},
        #{plane_types,mode=IN,jdbcType=VARCHAR},
        #{sale_organization,mode=IN,jdbcType=VARCHAR},
        #{clazz,mode=IN,jdbcType=VARCHAR},
        #{passenger_type,mode=IN,jdbcType=VARCHAR},
        #{passenger_age,mode=IN,jdbcType=NUMERIC},
        #{passenger_identity,mode=IN,jdbcType=VARCHAR},
        #{passenger_region_type,mode=IN,jdbcType=VARCHAR},
        #{passenger_region,mode=IN,jdbcType=VARCHAR},

        #{sale_point,mode=IN,jdbcType=VARCHAR},
        #{ticket_point,mode=IN,jdbcType=VARCHAR},
        #{sale_currency,mode=IN,jdbcType=VARCHAR},
        #{fare_base,mode=IN,jdbcType=VARCHAR},
        #{fare_amount,mode=IN,jdbcType=NUMERIC},

        #{ob_fee,mode=IN,jdbcType=NUMERIC},
        #{services_flight_related_fee,mode=IN,jdbcType=NUMERIC},
        #{services_ticket_related_fee,mode=IN,jdbcType=NUMERIC},
        #{services_merchandise_fee,mode=IN,jdbcType=NUMERIC},
        #{services_oc_fee,mode=IN,jdbcType=NUMERIC},
        #{baggage_charges,mode=IN,jdbcType=NUMERIC},
        #{od_fee,mode=IN,jdbcType=NUMERIC},
        #{departure_date,mode=IN,jdbcType=VARCHAR},
        #{arrival_date,mode=IN,jdbcType=VARCHAR},
        <!-- 燃油费已归入Tax -->
        <!--#{routing_yq_amount,mode=OUT,jdbcType=NUMERIC},-->
        <!--#{routing_yr_amount,mode=OUT,jdbcType=NUMERIC},-->
        #{result_set,jdbcType=CURSOR,javaType=java.sql.ResultSet,resultMap=SegmentTax,mode=OUT},
        <!-- resultMap游标支持一个或多个对象查询 -->
        #{return_label,mode=OUT,jdbcType=INTEGER}
        )}
    </select>
</mapper>
